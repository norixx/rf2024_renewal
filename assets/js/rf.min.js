(function () {
  'use strict';

  let rf_globals = {
    window_state: 'SP', // or PC
    breakpoint: 768,
  };

  const rf_set_globals = settings => {

    rf_globals = {
      ...rf_globals,
      ...settings,
    };
  };

  const rf_get_globals = key => {
    return rf_globals[key]
  };

  const rf_responsive_check = () => {
    window.addEventListener('resize', () => {
      requestAnimationFrame(() => {
        let current_state = rf_get_globals('window_state');

        if (window.innerWidth < rf_get_globals('breakpoint') && current_state === 'PC') {
          rf_set_globals({
            window_state: 'SP',
          });
          console.log('SP');
        } else if (window.innerWidth >= rf_get_globals('breakpoint') && current_state === 'SP') {
          rf_set_globals({
            window_state: 'PC',
          });
          console.log('PC');
        }

      });
    });

    // åˆå‹•
    window.dispatchEvent(new Event('resize'));
  };

  const rf_gnav = () => {
    let _isOpen = false; //ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã®é–‹é–‰çŠ¶æ…‹
    let _isOpenSub = false; // PCç”¨ - ã®Lv2ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã®é–‹é–‰çŠ¶æ…‹
    let _current = null; // ç¾åœ¨é–‹ã„ã¦ã„ã‚‹Lv1ã®ID
    let _currentSub = null; // PCç”¨ - ç¾åœ¨é–‹ã„ã¦ã„ã‚‹Lv2ã®ID
    const gnavID = 'gnav-main';
    const openClass = '--is-open';
    const lv1Flag = 'jsGnavLv1'; // Lv1ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ•ãƒ©ã‚°(datasetå)
    // const gnavBtnPC = document.querySelectorAll('[data-js-gnav-pc]')
    const gnav = document.querySelector(`#${gnavID}`); //ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³æœ¬ä½“
    const gnavBtn = document.querySelector('#gnav-btn-open');
    const gnavBtnClose = document.querySelector('[data-js-gnav-close]');
    const gnavSubContainer = document.querySelector('#gnav-sub-container');
    const gnavBtnSubContClose = document.querySelector('[data-js-gnav-sub-container-close]');
    const gnavToggles = document.querySelectorAll('[data-js-gnav-sub]');
    const gnavToggleTargets = Array.from(gnavToggles).map(toggle => document.querySelector(toggle.dataset.jsGnavSub));
    const gnavClose = document.querySelectorAll(['[data-js-gnav-sub-close]']);

    // Gnavã‚’é–‰ã˜ã‚‹ + ã™ã¹ã¦ã‚’é–‰ã˜ã‚‹
    const _hideGnav = () => {
      _isOpen = false;
      gnav.classList.remove(openClass);

      // PC ã‚µãƒ–ã‚³ãƒ³ãƒ†ãƒŠã‚’é–‰ã˜ã‚‹
      _isOpenSub = false;
      _current = null;
      _currentSub = null;
      gnavSubContainer.classList.remove(openClass);


      // openClassã‚’å…¨ã¦å‰Šé™¤
      gnavToggles.forEach(target => {
        target.classList.remove(openClass);
      });
      gnavToggleTargets.forEach(target => {
        target.classList.remove(openClass);
      });

    };

    // Gnavã‚’é–‹ã
    const _showGnav = () => {
      _isOpen = true;
      gnav.classList.add(openClass);
    };

    // SP - Gnav(è‡ªä½“)ã‚’ã‚¿ãƒƒãƒ—ã—ãŸã‚‰é–‰ã˜ã‚‹
    gnav.addEventListener('click', e => {
      const target = e.target;
      // console.log(target.id)
      if (target.id !== gnavID) return
      _hideGnav();
    });

    // SP - Gnavã‚’é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³
    gnavBtnClose.addEventListener('click', e => {
      _hideGnav();
    });

    // SP - GnavğŸ”
    gnavBtn.addEventListener('click', e => {
      if (_isOpen && gnav.classList.contains(openClass)) {
        _hideGnav();
      } else {
        _showGnav();
      }
    });

    // Gnav Toggles
    gnavToggles.forEach(toggle => {
      toggle.addEventListener('click', e => {
        console.log('ã‚¯ãƒªãƒƒã‚¯å‰ã®Lv2: ', _currentSub);
        const targetID = toggle.dataset.jsGnavSub;

        // PC - Lv1éƒ¨åˆ†ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸå ´åˆ
        if (lv1Flag in toggle.dataset && rf_get_globals('window_state') === 'PC') {
          console.log('PC Lv1 ã‚¯ãƒªãƒƒã‚¯: ', targetID);

          // â–¼ ã‚µãƒ–ã‚³ãƒ³ãƒ†ãƒŠåˆ¶å¾¡
          // 1. é–‹ã„ã¦ã„ã‚‹ + åŒã˜ => é–‰ã˜ã‚‹
          if (_isOpenSub && _currentSub === targetID) {
            console.log('PC ã‚µãƒ–ã‚³ãƒ³ãƒ†ãƒŠé–‰ã˜ã‚‹');
            _hideGnav();

            return //å‡¦ç†ã¯ä¸­æ­¢
          }
          // 2. é–‹ã„ã¦ã„ã‚‹ + é•ã† => åˆ‡ã‚Šæ›¿ãˆã‚‹ï¼ˆé–‹ãï¼‰
          if (_isOpenSub && _currentSub !== targetID) {
            console.log('PC ã‚µãƒ–ã‚³ãƒ³ãƒ†ãƒŠåˆ‡ã‚Šæ›¿ãˆ');

            // 1ã¤å‰ã®ã‚µãƒ–ã‚³ãƒ³ãƒ†ãƒŠ
            document.querySelector(_currentSub).classList.remove(openClass);
          }

          // 3. é–‹ã„ã¦ã„ãªã„ => é–‹ã
          if (_isOpenSub === false) {
            _showGnav(); // Gnavã‚’é–‹ã(SPç”¨ã ã‘ã©ä¸€å¿œå®Ÿè¡Œ)
            gnavSubContainer.classList.add(openClass); //ã‚µãƒ–ã‚³ãƒ³ãƒ†ãƒŠã‚’é–‹ã
            _isOpenSub = true;
          }
        }

        _currentSub = targetID;

        console.log('ã‚¯ãƒªãƒƒã‚¯å¾Œã®Lv2: ', _currentSub);
        console.log(_isOpenSub);

        // SP - Lv1éƒ¨åˆ†ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸå ´åˆã§ã‚‚ä¸€å¿œã‚µãƒ–ã‚³ãƒ³ãƒ†ãƒŠã‚’é–‹ã
        if (
          lv1Flag in toggle.dataset &&
          _isOpenSub !== true &&
          rf_get_globals('window_state') === 'SP'
        ) {
          gnavSubContainer.classList.add(openClass); //ã‚µãƒ–ã‚³ãƒ³ãƒ†ãƒŠã‚’é–‹ã
          _isOpenSub = true;
        }

        // PC & SP - ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®openClassã‚’ãƒˆã‚°ãƒ«
        document.querySelector(targetID).classList.add(openClass);

        // PC & SP - Lv1ã‚’æ›´æ–°
        if (lv1Flag in toggle.dataset) {
          // 1ã¤å‰ã®Lv1ãƒªãƒ³ã‚¯ã‹ã‚‰openClassã‚’å‰Šé™¤ã—ã€æ–°ã—ã„ã‚‚ã®ã¸è¿½åŠ 
          const _prev = document.querySelector(`[data-js-gnav-lv1=${_current}]`);
          console.log('1ã¤å‰ã®Lv1', _prev);
          if (_prev) {
            _prev.classList.remove(openClass);
          }

          _current = toggle.dataset[lv1Flag];
          console.log('ä¿å­˜ã—ãŸLv1', _current);
          toggle.classList.add(openClass);
        }
      });
    });

    // PC - ã‚µãƒ–ã‚³ãƒ³ãƒ†ãƒŠã‚’é–‰ã˜ã‚‹
    gnavBtnSubContClose.addEventListener('click', () => {
      _hideGnav();
    });

    // SP - ã‚µãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‰ã˜ã‚‹
    gnavClose.forEach(close => {
      close.addEventListener('click', () => {
        const target = document.querySelector(close.dataset.jsGnavSubClose);
        if (target.classList.contains(openClass)) target.classList.remove(openClass);
      });
    });


  };

  // Toggle å…±é€š

  const rf_toggles = () => {
    const toggles = document.querySelectorAll('[data-js-toggle]');
    const toggleSPClass = 'toggle-sp-only';
    const togglePCClass = 'toggle-pc-only';
    const toggleClass = '--is-open';

    console.dir(toggles);
    toggles.forEach(toggle => {
      const target = document.querySelector(toggle.dataset.jsToggle);
      // åˆå‹•
      if (toggle.classList.contains(toggleClass) && !target.classList.contains(toggleClass)) {
        target.classList.add(toggleClass);
      }

      // ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒã‚§ãƒƒã‚¯
      toggle.addEventListener('click', e => {
        const self = e.target;

        if (self.classList.contains(toggleSPClass) && rf_get_globals('window_state') !== 'SP') {
          return
        }
        if (self.classList.contains(togglePCClass) && rf_get_globals('window_state') !== 'PC') {
          return
        }
        self.classList.toggle(toggleClass);
        // const target = document.querySelector(toggle.dataset.toggle)
        target.classList.toggle(toggleClass);
      });
    });
  };

  // TOPãƒãƒŠãƒ¼ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼
  const rf_top_banners = () => {
    const args = {
      breakpoints: {
        0: {
          slidesPerView: 1.3,
          spaceBetween: 16,
          slidesOffsetAfter: 16,
          slidesOffsetBefore: 16,
        },
        768: {
          slidesPerView: 4.3,
          spaceBetween: 24,
          slidesOffsetAfter: 24,
          slidesOffsetBefore: 24,
        },
      },
    };
    const banner = new Swiper('[data-js-top-banners]', args);
    console.log(banner);
  };

  // ç‰©ä»¶ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼
  const rf_prop_slider = () => {
    const propSliders = document.querySelectorAll('[data-js-prop-slider]');
    let sliders = {};

    const args = {
      navigation: {
        nextEl: ".swiper-button-next",
        prevEl: ".swiper-button-prev",
      },
      pagination: {
        el: ".c-prop-slider__pagination",
        type: "progressbar",
      },
      breakpoints: {
        0: {
          spaceBetween: 16,
          slidesPerView: 1.2,
          slidesOffsetBefore: 32,
          slidesOffsetAfter: 32,
        },
        768: {
          spaceBetween: 24,
          slidesPerView: 4.4,
          slidesOffsetBefore: 40,
          slidesOffsetAfter: 40,
        },
      },
    };

    propSliders.forEach(slider => {
      const propSlider = new Swiper(slider, args);
      console.dir(slider);
      sliders[slider.id] = propSlider;
    });

    console.log(sliders);

  };

  // ãŠéƒ¨å±‹ãƒªã‚¹ãƒˆ


  // éƒ¨å±‹ãƒªã‚¹ãƒˆãƒªãƒ³ã‚¯
  const rf_room_list_link = () => {
    const links = document.querySelectorAll('[data-js-room-link]');

    links.forEach(link => {
      link.addEventListener('click', e => {
        e.stopPropagation();
        const clicked = e.target;

        if (clicked.tagName === 'A' || clicked.tagName === 'BUTTON') {
          console.log('ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–è¦ç´ ãªã®ã§ä¸­æ­¢');
          return
        }

        const target = link.dataset.jsRoomLink;
        window.open(target, '_blank');
      });
    });
  };

  // ãŠéƒ¨å±‹ãƒªã‚¹ãƒˆã®åˆ¶å¾¡
  const rf_room_list_toggle = () => {
    const openClass = '--is-open';
    let tempText = '';
    const maxHeightPC = 660;
    const maxHeightSP = 1200;
    const toggles = document.querySelectorAll('[data-js-room-toggle]');


    // ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«, ç”»åƒã®èª­ã¿è¾¼ã¿ãªã©ã‚’è€ƒæ…®ã—ã¦windowãƒ­ãƒ¼ãƒ‰å¾Œ
    window.addEventListener('load', () => {
      toggles.forEach(toggle => {
        const target = document.querySelector(toggle.dataset.jsRoomToggle);

        // ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³ã®è¡¨ç¤ºãƒ»éè¡¨ç¤ºã‚’ã¾ãšæ±ºã‚ã‚‹ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: è¡¨ç¤ºï¼‰
        if (rf_get_globals('window_state') === 'PC' && target.scrollHeight < maxHeightPC) {
          toggle.classList.add('--is-hide');
        } else if (rf_get_globals('window_state') === 'SP' && target.scrollHeight < maxHeightSP) {
          toggle.classList.add('--is-hide');
        }

        // ã‚¯ãƒªãƒƒã‚¯ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«
        toggle.addEventListener('click', () => {

          target.classList.toggle(openClass);
          toggle.classList.toggle(openClass);

          // é«˜ã•
          if (target.classList.contains(openClass)) {
            target.style.maxHeight = target.scrollHeight + 'px';
          } else {
            target.style.maxHeight = null;
          }


          // ãƒ†ã‚­ã‚¹ãƒˆ
          if ('jsRoomToggleText' in toggle.dataset) {
            tempText = toggle.textContent;
            toggle.textContent = toggle.dataset.jsRoomToggleText;
            toggle.dataset.jsRoomToggleText = tempText;
          }
        });
      });
    });

  };

  // å»ºç‰©ãƒ»éƒ¨å±‹ å…±é€š

  const rf_buildroom_main_slide = () => {
    const mv_thumbs_args = {
      spaceBetween: 8,
      freeMode: true,
      watchSlidesProgress: true,
      breakpoints: {
        0: {
          slidesPerView: 4,
        },
        768: {
          slidesPerView: 8,
        },
      },
    };
    const mv_thumbs = new Swiper('[data-js-buildroom-mv-thumbs]', mv_thumbs_args);

    const mv_args = {
      pagination: {
        el: ".swiper-pagination",
        type: "fraction",
      },
      navigation: {
        nextEl: ".swiper-button-next",
        prevEl: ".swiper-button-prev",
      },
      thumbs: {
        swiper: mv_thumbs,
      },
    };
    new Swiper('[data-js-buildroom-mv]', mv_args);
  };

  const rf_modals = () => {
    const modalOpenHtmlClass = '--is-modal-open';
    const modalOpenClass = '--is-open';
    const html = document.documentElement;
    // const modalClass = 'c-modal'
    // const modals = document.querySelectorAll('.' + modalClass)
    const modals = document.querySelectorAll('[data-js-modal-target]');
    const modalOpenBtns = document.querySelectorAll('[data-js-modal]');
    const modalTargetName = 'jsModalTarget';
    // const modalCloseBtns = document.querySelectorAll('[data-js-modal-close]')
    let openedModals = [];

    // é–‹ããƒœã‚¿ãƒ³
    modalOpenBtns.forEach(btn => {
      const modalId = btn.dataset.jsModal;
      const targetModal = document.querySelector(modalId);

      btn.addEventListener('click', () => {
        targetModal.classList.add(modalOpenClass);
        html.classList.add(modalOpenHtmlClass);
        openedModals.push(modalId);
        // console.log('openedModalsã¯?', openedModals)
      });
    });

    // ãƒ¢ãƒ¼ãƒ€ãƒ«é–‰ã˜ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
    const _closeModal = (modal) => {
      // console.log('ãƒ¢ãƒ¼ãƒ€ãƒ«é–‰ã˜ã‚‹, openedModalsã¯?', openedModals)
      console.log(modal.id);
      const index = openedModals.indexOf(modal);
      openedModals.splice(index, 1);
      // console.log('ãƒ¢ãƒ¼ãƒ€ãƒ«é–‰ã˜ãŸã‚ã¨, openedModalsã¯?', openedModals)
      modal.classList.remove(modalOpenClass);
      if (openedModals.length === 0) {
        html.classList.remove(modalOpenHtmlClass);
      }
    };

    // ãƒ¢ãƒ¼ãƒ€ãƒ«åˆ¶å¾¡
    modals.forEach(modal => {
      // ãƒ¢ãƒ¼ãƒ€ãƒ«æœ¬ä½“é–‰ã˜ã‚‹
      modal.addEventListener('click', e => {
        if (modalTargetName in e.target.dataset) {
          console.log('ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ');
          _closeModal(modal);
        }
      });

      // ãƒ¢ãƒ¼ãƒ€ãƒ«é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³
      const modalCloses = modal.querySelectorAll('[data-js-modal-close]');
      modalCloses.forEach(close => {
        close.addEventListener('click', () => {
          _closeModal(modal);
        });
      });

    });

  };

  // CTAãƒŠãƒ“
  const rf_cta_navi_tel = () => {
    // const nav = document.querySelector('.c-cta-navi-tel');
    const btn = document.querySelector(['[data-js-cta-navi-tel]']);
    const nav = document.querySelector(btn.dataset.jsCtaNaviTel);

    btn.addEventListener('click', () => {
      nav.classList.toggle('--is-open');
    });
  };

  const rf_select_link = () => {

    const selectLinks = document.querySelectorAll('[data-js-select-link]');

    selectLinks.forEach(link => {
      link.addEventListener('change', e => {
        const href = e.target.selectedOptions[0].value;
        location.href = href;
      });
    });
  };

  // import rf_globals from './partials/_globals';

  // =======================================================
  // Inits

  // Viewport checker (SP or PC)
  rf_responsive_check();

  // Global Navigation
  if (document.querySelector('[data-js-gnav]')) {
    rf_gnav();
  }

  // Toggles
  if (document.querySelector('[data-js-toggle]')) {
    rf_toggles();
  }

  // Topãƒšãƒ¼ã‚¸ - ãƒãƒŠãƒ¼
  if (document.querySelector('[data-js-top-banners]')) {
    rf_top_banners();
  }

  // ç‰©ä»¶ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼
  if (document.querySelector('[data-js-prop-slider]')) {
    rf_prop_slider();
  }

  // ãŠéƒ¨å±‹ãƒªã‚¹ãƒˆãƒªãƒ³ã‚¯
  if (document.querySelector('[data-js-room-link]')) {
    rf_room_list_link();
    rf_room_list_toggle();
  }

  // å»ºç‰©ãƒ»éƒ¨å±‹å…±é€š
  if (document.querySelector('[data-js-buildroom-mv]')) {
    rf_buildroom_main_slide();
  }
  if (document.querySelector('[data-js-buildroom-mv-thumbs]')) ;

  // ãƒ¢ãƒ¼ãƒ€ãƒ«
  if (document.querySelector('[data-js-modal]')) {
    rf_modals();
  }

  // CTAãƒŠãƒ“
  if (document.querySelector('[data-js-cta-navi-tel]')) {
    rf_cta_navi_tel();
  }

  // ã‚»ãƒ¬ã‚¯ãƒˆãƒªãƒ³ã‚¯
  if (document.querySelector('[data-js-select-link]')) {
    rf_select_link();
  }

})();
//# sourceMappingURL=rf.min.js.map
